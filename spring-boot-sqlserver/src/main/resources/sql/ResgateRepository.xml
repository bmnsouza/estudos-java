<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"
  version="2.0">

  <named-native-query name="ResgateModel.buscaConferencia" result-class="br.gov.se.sefaz.ndgbackend.model.ResgateModel">
    <query>
      <![CDATA[
        select * from (select usu.cpf, usu.nome, usu.logradouro, usu.numero, usu.bairro, usu.cep, usu.municipio, usu.uf, tra.codBanco, nfa.nomeBanco,
        tra.strAgencia, tra.strDigAgencia, tra.strNumConta, tra.strDigConta, mov.codTipoMov, tra.valValorCredito, tra.valValorCreditoBruto,
        tra.valValorDescontoIR, tra.operacao, tra.tra_status from NFP_ContaCorrente..Transferencia tra, NFP_ContaCorrente..Movimentacao mov,
        UsuarioCAT..tb_UsuarioCat_CPF usu, NFP_ContaCorrente..NFA_Bancos nfa where tra.codMovimentacao = mov.codMovimentacao and tra.strCpfCnpjUser = usu.cpf
        and tra.codBanco = nfa.pkBanco and tra.codBanco = 47 and mov.codTipoMov in (1, 2) and tra_status in (0, 1)) q order by tra_status, nome
      ]]>
    </query>
  </named-native-query>

  <named-native-query name="ResgateModel.buscaRealizado" result-class="br.gov.se.sefaz.ndgbackend.model.ResgateModel">
    <query>
      <![CDATA[
        select * from (select usu.cpf, usu.nome, usu.logradouro, usu.numero, usu.bairro, usu.cep, usu.municipio, usu.uf, tra.codBanco, nfa.nomeBanco,
        tra.strAgencia, tra.strDigAgencia, tra.strNumConta, tra.strDigConta, mov.codTipoMov, tra.valValorCredito, tra.valValorCreditoBruto,
        tra.valValorDescontoIR, tra.operacao, tra.tra_status from NFP_ContaCorrente..Transferencia tra, NFP_ContaCorrente..Movimentacao mov,
        UsuarioCAT..tb_UsuarioCat_CPF usu, NFP_ContaCorrente..NFA_Bancos nfa where tra.codMovimentacao = mov.codMovimentacao and tra.strCpfCnpjUser = usu.cpf
        and tra.codBanco = nfa.pkBanco and tra.codBanco = 47 and mov.codTipoMov in (1, 2) and cast(dtGeracaoRelatorio as date) = ?1) q order by tra_status, nome
      ]]>
    </query>
  </named-native-query>

  <named-native-query name="ResgateModel.buscaNaoRealizado">
    <query>
      <![CDATA[
        select ucp.nome "nome" from NFP_ContaCorrente..Saldo sal join NFP_ContaCorrente..ContaCorrente cco on (sal.pkSaldo = cco.pkConta) join
        USUARIOCAT..tb_UsuarioCat_CPF ucp on (cco.strCpfCnpjUser = ucp.cpf) where sal.valValorSaldo > 0 and upper(ucp.estado) in ('ATIVO', 'BLOQUEADO')
        and upper(ucp.situacao) = 'ATIVO' group by ucp.nome order by ucp.nome
      ]]>
    </query>
  </named-native-query>

</entity-mappings>